<!doctype html>
<html>

<head>
    <title>ohm/js test demo</title>
    <meta charset=utf-8>
    <script type="text/javascript" src="ohm.js"></script>

<script type="text/javascript" >
  let defaultWord=    
//    "reinternationalization"
//    "reinternationalization"
//    "internutionalizations"
    "reinternationalizations"
//    "remove"
</script>

    <script type="text/ohm-js">

EnglishMorphology {

  Verb = 
    | GenericPrefix Verb -- gvprefix
    | Adj AdjToVerbSuffix -- vcomplexs
    | Verb VerbTenseSuffix -- nplural
    | VerbStem -- nsimple

  Noun = 
    | GenericPrefix Noun -- gnprefix
    | Verb VerbToNounSuffix -- ncomplexs
    | Noun NounPluralSuffix -- nplural
    | NounStem -- nsimple

  Adj = 
    | Noun NounToAdjSuffix -- acomplexs

  GenericPrefix = 
    | "inter"
    | "re"

  NounToAdjSuffix = 
    | "al"

  NounPluralSuffix = 
    | "es"
    | "s"

  VerbTenseSuffix = 
    | "ed"
    | "d"

  AdjToVerbSuffix = 
    | "ize"
    | "iz"

  VerbToNounSuffix = 
    | "ation"

  NounStem = 
    | KnownNounStem  
    | UnknownStem  

  KnownNounStem = 
    | "nation"

  VerbStem = 
    | KnownVerbStem  
    | UnknownStem  

  KnownVerbStem = 
    | "move"

  UnknownStem = Letters
  Letters = Letter+
  Letter =  ~(NounToAdjSuffix | AdjToVerbSuffix| VerbToNounSuffix|NounPluralSuffix) ALetter
  ALetter = letter
}

    </script>
</head>

<body>
    <input id="input" type="text"></inpjt>
    <pre id="result"></pre>
    <script type="text/javascript">
    // Instantiate the grammar defined above.
    var g = ohm.grammarFromScriptElement();

    // Define an operation named 'eval' which evaluates the expression.
    // See https://github.com/cdglabs/ohm/blob/master/doc/api-reference.md#semantics
    var semantics = g.createSemantics().addOperation('eval', {
        Adj: function(word) {
            return word;
        },
        Noun: function(word) {
            return word;
        },
        Verb: function(word) {
            return word;
        },
    });

    document.getElementById('input').value = defaultWord // "commonality"
    document.getElementById('input').onblur = function(e){
    	let word = document.getElementById('input').value 

      let result="";
      ["Noun","Verb","Adj"].forEach(goal=>{ 
         result += "\n-----------\n" + goal + "\n---------\n"
  	    let m = g.match(word, goal);
  	    if (m.succeeded()) {
           result += "Success\n" 
  	        //result = "ok"; // Evaluate the expression.
  	        let res  = semantics(m).eval(); // Evaluate the expression.
  	        result += JSON.stringify(res._node, null, 2)
  	    } else {
           result += "Failed\n" 
  	        result += "\n" + m.message; // Extract the error message.
            result += "\n" + JSON.stringify(g.trace(word, goal).bindings, null, 2)
  	    }
      })
      document.getElementById('result').textContent = result;
    };

    document.getElementById('input').blur()

    </script>
</body>

</html>